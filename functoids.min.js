(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=[].slice;"undefined"!=typeof require&&null!==require?(s=require("underscore"),a=require("./index")):(a=this.F,s=this._),m={isOnlyElement:function(a,b){return s.isArray(a)&&1===a.length&&a[0]===b},firstOrSelf:function(a){return s.isArray(a)?a[0]:a},secondOrNull:function(a){var b;return s.isArray(a)?null!=(b=a[1])?b:null:null},popIfObject:function(a){return s.isArray(a)&&s.isObject(a[a.length-1])?a.pop():null},popIfNull:function(a){return s.isArray(a)&&null===a[a.length-1]?a.pop():void 0},pluckMany:function(){var b,c,d,e,f,g,h,i,j;for(b=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],a.demandArray(b,"arr"),a.demandArrayOfGoodStrings(e,"keys"),f=[],g=0,i=b.length;i>g;g++)for(c=b[g],h=0,j=e.length;j>h;h++)d=e[h],d in c&&f.push(a.result(c,d));return f},toDictionary:function(b,c){var d,e,f,g,h,i;for(a.demandArray(b,b),a.demandGoodString(c,"key"),f={},e=h=0,i=b.length;i>h;e=++h)d=b[e],g=d[c],null==g&&a["throw"]("Element "+d+" at position "+e+" has nil '"+c+"'"),g in f&&a["throw"]("Element "+d+" at position "+e+" has repeat value '"+g+"' for '"+c+"'"),f[g]=d;return f},unwrapSingle:function(a){return s.isArray(a)&&1===a.length?a[0]:a},lastIfFunction:function(a){var b,c;return b=a.length-1,b>=0&&(c=a[b],s.isFunction(c))?c:null},unwrapArgs:function(a,b){var c,d,e;if(e=b?a.length-1:a.length,0>=e)return null;if(1===e)return a[0];for(c=Array(e),d=0;e>d;)c[d]=a[d],d++;return c}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=m:s.extend(this.F,m),"undefined"!=typeof require&&null!==require?(s=require("underscore"),a=require("./index"),g=require("../inflector")):(a=this.F,s=this._,g=a.inflector),m={"throw":function(){var a;throw a=Array.prototype.join.call(arguments," "),new Error(a)},result:function(b,c){var d;return null!=c?(a.demandObject(b,"arg1"),a.demandGoodString(c,"arg2"),d=b[c],s.isFunction(d)?d.call(b):d):s.isFunction(b)?b():b}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=m:s.extend(this.F,m),"undefined"==typeof exports?null==this.F&&(this.F={}):(s=require("underscore"),s.extend(exports,require("./validator"),require("./core"),require("./math"),require("./array"),require("./string"),require("./logger")),exports.inflector=require("../inflector")),"undefined"!=typeof require&&null!==require?(q=require("util"),s=require("underscore")):s=this._,h=function(a){return null!=(null!=q?q.inspect:void 0)?q.inspect(a):a},p=function(){var a;return a=(new Date).toISOString(),"["+a+"] - "},f=function(a){return s.isString(a)?a:h(a)},o=function(){return null!=("undefined"!=typeof process&&null!==process?process.stdout:void 0)?process.stdout.write.apply(this,arguments):console.log.apply(this,arguments)},n=function(){return null!=("undefined"!=typeof process&&null!==process?process.stderr:void 0)?process.stderr.write.apply(this,arguments):console.error.apply(this,arguments)},j=Boolean(o.isTTY),i=Boolean(n.isTTY),c=j?"[36m[info][0m":"",b=i?"[31m[error][0m":"",m={logAll:function(a){return a=f(a),a=c+p()+a,o(""+a+"\n"),n(""+a+"\n")},logInfo:function(a,b){var d;return d=[c+p()+f(a)],null!=b&&d.push(h(b)),d.push(""),o(d.join("\n"))},logError:function(a,c){var d,e,g;return e=[],d=b+p(),a instanceof Error?(d+=a.message,g=a.stack):(d+=f(a),g=(new Error).stack),e=[d,g],null!=c&&e.push(h(c)),e.push(""),n(e.join("\n"))}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=m:s.extend(this.F,m),"undefined"!=typeof require&&null!==require?(s=require("underscore"),a=require("./index")):(a=this.F,s=this._),m={evenRound:function(b,c){var d,e,f,h,i;return a.demandGoodNumber(b,"num"),d=c||0,f=Math.pow(10,d),h=+(d?b*f:b).toFixed(8),g=Math.floor(h),e=h-g,i=.5===e?g%2===0?g:g+1:Math.round(h),d?i/f:i},round:function(b,c){return a.demandGoodNumber(b,"num"),Number(b.toFixed(c))}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=m:s.extend(this.F,m),"undefined"!=typeof require&&null!==require?(s=require("underscore"),a=require("./index"),g=require("../inflector")):(a=this.F,s=this._,g=a.inflector),e=["''",'""',"{}","[]","()"],l=/<(?:.|\n)*?>/gm,m={delimiters:e,toPlural:function(a){return g.inflect(a,!0)},toSingular:function(a){return g.inflect(a,!1)},underscore:function(a){return a.replace(/[-\s]+/g,"_").replace(g.acronymRegExp,function(a,b,c){return(c>0?"_":"")+b.toLowerCase()}).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").toLowerCase()},spacify:function(a){return m.underscore(a).replace(/_/g," ")},toCamelCase:function(b,c){return m.underscore(b).replace(/(^|_)([^_]+)/g,function(b,d,e,f){var h,i;return h=g.acronyms[e],i=c!==!1||f>0,h?i?h:h.toLowerCase():i?a.toUpperInitial(e):e})},tryUpper:function(a){return s.isString(a)?a.toUpperCase():a},tryLower:function(a){return s.isString(a)?a.toLowerCase():a},toUpperInitial:function(a){var b;return b=a.charAt(0).toUpperCase(),1===a.length?b:b+a.slice(1)},toLowerInitial:function(a){var b;return b=a.charAt(0).toLowerCase(),1===a.length?b:b+a.slice(1)},undelimit:function(){var a,b,c,d,f,g;for(d=arguments[0],a=2<=arguments.length?t.call(arguments,1):[],c=a.length>0?a:e,f=0,g=c.length;g>f;f++)if(b=c[f],d.charAt(0)===b.charAt(0)&&d.charAt(d.length-1)===b.charAt(1))return d.slice(1,d.length-1);return d},stripHtml:function(b){return a.demandString(b,"s"),b.replace(l,"")},repeat:function(a,b){return Array(b+1).join(a)},padLeft:function(a,b,c){return null==c&&(c=" "),a=a.toString(),a.length>=b?a:m.repeat(c,b-a.length)+a},endsWith:function(b,c){return a.demandGoodString(b,"str"),a.demandGoodString(c,"suffix"),-1!==b.indexOf(c,b.length-c.length)},startsWith:function(b,c){return a.demandGoodString(b,"str"),a.demandGoodString(c,"prefix"),b.slice(0,c.length)===c},alike:function(b,c){return null==b&&(b=""),null==c&&(c=""),a.demandString(b,"a"),a.demandString(c,"b"),b=b.toLowerCase().trim(),c=c.toLowerCase().trim(),b===c}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=m:s.extend(this.F,m),s="undefined"!=typeof require&&null!==require?require("underscore"):this._,d=function(a,b,c){var d;throw d=["Argument ",null!=b?"'"+b+"' ":"","must ",null!=c?c:a].join(""),new Error(d)},k=/\S/,r={demandNotNil:function(a,b,c){return null!=a?!0:d("not be null or undefined",b,c)},demandNonEmpty:function(a){return s.isArray(a)?r.isGoodArray(a):void 0},demandArray:function(a,b,c){return s.isArray(a)?!0:d("be an array",b,c)},demandNonEmptyArray:function(a,b,c){return s.isArray(a)&&!s.isEmpty(a)?!0:d("be a non-empty array",b,c)},demandGoodArray:function(a,b,c){return r.isGoodArray(a)?!0:d("be a non-empty array free of nil elements",b,c)},demandArrayOfStrings:function(a,b,c){return r.isArrayOfStrings(a)?!0:d("be an array of strings",b,c)},demandArrayOfGoodStrings:function(a,b,c){return r.isArrayOfGoodStrings(a)?!0:d("be an array of non-empty, non-all-whitespace strings",b,c)},demandArrayOfGoodNumbers:function(a,b,c){return r.isArrayOfGoodNumbers(a)?!0:d("be an array of non-infinity, non-NaN numbers",b,c)},demandObject:function(a,b,c){return s.isObject(a)?!0:d("be an object",b,c)},demandGoodObject:function(a,b,c){return r.isGoodObject(a)?!0:d("be a defined, non-empty object",b,c)},demandType:function(a,b,c,e){return r.isOfType(a,b)?!0:d("be an object of type '"+(b.name||b)+"'",c,e)},demandKeys:function(a,b,c,e){var f;return r.hasKeys(a,b)?!0:(f=b.join(", "),d("be a defined object containing ["+f+"] key(s)",c,e))},demandHash:function(a,b,c){return r.isHash(a)?!0:d("be a non-empty, non-array object (ie, a hash)",b,c)},demandFunction:function(a,b,c){return s.isFunction(a)?!0:d("be a function",b,c)},demandString:function(a,b,c){return s.isString(a)?!0:d("be a string",b,c)},demandGoodString:function(a,b,c){return r.isGoodString(a)?!0:d("be a non-empty, non-all-whitespace string",b,c)},demandNumber:function(a,b,c){return s.isNumber(a)?!0:d("be a number",b,c)},demandGoodNumber:function(a,b,c){return r.isGoodNumber(a)?!0:d("be a number",b,c)},demandBoolean:function(a,b,c){return s.isBoolean(a)?!0:d("be a boolean value",b,c)},demandDate:function(a,b,c){return s.isDate(a)?!0:d("be a Date",b,c)},isHash:function(a){return s.isObject(a)&&!s.isEmpty(a)&&!s.isArray(a)},isGoodObject:function(a){return s.isObject(a)&&!s.isEmpty(a)},hasKeys:function(a,b){return r.demandArrayOfGoodStrings(b,"keys"),r.isGoodObject(a)?s.every(b,function(b){return b in a}):!1},isGoodArray:function(a){var b,c,d;if(!s.isArray(a)||s.isEmpty(a))return!1;for(c=0,d=a.length;d>c;c++)if(b=a[c],null==b)return!1;return!0},isGoodString:function(a){return s.isString(a)&&a.length>0?k.test(a):!1},isGoodNumber:function(a){return s.isNumber(a)&&s.isFinite(a)&&!isNaN(a)},isArrayOfStrings:function(a){var b,c,d;if(!s.isArray(a))return!1;for(c=0,d=a.length;d>c;c++)if(b=a[c],!s.isString(b))return!1;return!0},isArrayOfGoodStrings:function(a){var b,c,d;if(!s.isArray(a))return!1;for(c=0,d=a.length;d>c;c++)if(b=a[c],!r.isGoodString(b))return!1;return!0},isArrayOfGoodNumbers:function(a){var b,c,d;if(!s.isArray(a))return!1;for(c=0,d=a.length;d>c;c++)if(b=a[c],!r.isGoodNumber(b))return!1;return!0},isOfType:function(a,b){return r.demandFunction(b,"t"),a instanceof b}},r.demandNonEmptyObject=r.demandGoodObject,null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=r:s.extend(this.F,r)}).call(this);